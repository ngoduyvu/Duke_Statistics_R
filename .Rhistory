data_mod <- select(gss, one_of(varsOfInterest))
View(data_mod)
countNAs <- apply(modData, 2, function(x) sum(is.na(x)))
modData <- select(gss, one_of(varsOfInterest))
countNAs <- apply(modData, 2, function(x) sum(is.na(x)))
countNAs_df <- as.data.frame(countNAs)#change to data frame
countNAs_df$cat <- row.names(countNAs_df)#copy row names to its own column (variable)
options(scipen=999)#prevents scientific notation
countNAs_df$percentNA <- format(countNAs_df$countNAs/nrow(modData), digits = 2)
countNAs_df$percentNA <- as.numeric(countNAs_df$percentNA)
plot5 <- ggplot(countNAs_df, aes(x = reorder(cat, -countNAs), y = countNAs),
ylab("NA Count"), xlab("Variable Name")) +
geom_bar(stat = "identity") +
theme(axis.ticks = element_blank(), axis.text.y = element_blank()) +
scale_y_continuous(labels = comma) +
xlab("Variable Names") + ylab("NA Count") + ggtitle("Count of NAs in Data") + coord_flip()
plot5
View(countNAs_df)
varsOfInterest <- c("year", "age", "sex", "race", "degree", "incom16", "relig", "attend", "class", "natspac")
modData <- select(gss, one_of(varsOfInterest))
countNAs <- apply(modData, 2, function(x) sum(is.na(x)))
countNAs_df <- as.data.frame(countNAs)#change to data frame
countNAs_df$cat <- row.names(countNAs_df)#copy row names to its own column (variable)
options(scipen=999)#prevents scientific notation
countNAs_df$percentNA <- format(countNAs_df$countNAs/nrow(modData), digits = 2)
modData <- select(gss, one_of(varsOfInterest))
countNAs <- apply(modData, 2, function(x) sum(is.na(x)))
countNAs_df <- as.data.frame(countNAs)#change to data frame
options(scipen=999)#prevents scientific notation
countNAs_df$percentNA <- format(countNAs_df$countNAs/nrow(modData), digits = 2)
countNAs_df$percentNA <- as.numeric(countNAs_df$percentNA)
plot5 <- ggplot(countNAs_df, aes(x = reorder(cat, -countNAs), y = countNAs),
ylab("NA Count"), xlab("Variable Name")) +
geom_bar(stat = "identity") +
theme(axis.ticks = element_blank(), axis.text.y = element_blank()) +
scale_y_continuous(labels = comma) +
xlab("Variable Names") + ylab("NA Count") + ggtitle("Count of NAs in Data") + coord_flip()
plot5 <- ggplot(countNAs_df, aes(x = reorder(cat, -countNAs), y = countNAs),
ylab("NA Count"), xlab("Variable Name")) +
geom_bar(stat = "identity") +
theme(axis.ticks = element_blank(), axis.text.y = element_blank()) +
#scale_y_continuous(labels = comma) +
xlab("Variable Names") + ylab("NA Count") + ggtitle("Count of NAs in Data") + coord_flip()
plot5
View(countNAs_df)
table(countNAs_df)
countNAs <- apply(modData, 2, function(x) sum(is.na(x)))
countNAs
modData2 <- modData %>% select("attend", "natspace")
modData2 <- modData %>% select("attend", "natspac")
View(modData)
modData2 <- modData %>% select("relig", "natspac")
modData2 <- select(modData, "relig", "natspac")
library(ggplot2)
library(dplyr)
library(statsr)
load("./Inferential/project/gss.Rdata")
varsOfInterest <- c("year", "age", "sex", "race", "degree", "incom16", "relig", "attend", "class", "natspac")
modData <- select(gss, one_of(varsOfInterest))
countNAs <- apply(modData, 2, function(x) sum(is.na(x)))
countNAs#25834
modData2 <- select(modData, "relig", "natspac")
class(gss)
class(modData)
modData2 <- select(modData, relig, natspac)
modData2 <- complete.cases(modData2)
modData2 <- modData2[complete.cases(modData2,]
modData2 <- modData2[complete.cases(modData2, )]
modData <- select(gss, one_of(varsOfInterest))
modData2 <- select(modData, relig, natspac)
modData2 <- modData2[complete.cases(modData2, )]
modData2 <- modData2 %>% filter(relig != NA, natspac != NA)
View(modData2)
modData2 <- modData2 %>% filter(relig != "NA", natspac != "NA")
modData2 <- select(modData, relig, natspac)
modData2 <- modData2 %>% filter(relig != "NA", natspac != "NA")
View(modData2)
ggplot(modData2, aes(x=relig)) +
geom_histogram(binwidth=1, colour="black", fill="white") +
xlab("Religion") +
ggtitle("Distribution of Religion")
ggplot(modData2, aes(x=relig), stat=count) +
geom_histogram(binwidth=1, colour="black", fill="white") +
xlab("Religion") +
ggtitle("Distribution of Religion")
table(modData2$relig, modData2$natspac)
modData2 <- select(modData, relig, attend, natspac)
modData2 <- modData2 %>% filter(relig != "NA", natspac != "NA")
table(modData2$attend, modData2$natspac)
modData2 <- select(modData, attend, natspac)
modData2 <- modData2 %>% filter(attend != "NA", natspac != "NA")
table(modData2$attend, modData2$natspac)
distinct(modData2)
distinct(modData2$attend)
levels(modData2$attend)
n_distinct(modData$attend)
?revalue
library(plyr)#Used for the revalue function
library(plyr)#Used for the revalue function
library(dplyr)
revalue(modData2$attend, c("Never" = "Rarely", "Lt Once A Year" = "Rarely", "Once A Year" = "Rarely",
"Sevrl Times A Yr" = "Rarely"))
n_distinct(modData$attend)
levels(modData2$attend)
revalue(modData2, c("Never" = "Rarely", "Lt Once A Year" = "Rarely", "Once A Year" = "Rarely",
"Sevrl Times A Yr" = "Rarely"))
modData3 <- revalue(modData2$attend, c("Never" = "Rarely", "Lt Once A Year" = "Rarely", "Once A Year" = "Rarely",
"Sevrl Times A Yr" = "Rarely"))
modData3
revalue(modData2$attend, c(Never = "Rarely", Lt Once A Year = "Rarely", Once A Year = "Rarely",
revalue(modData2$attend, c(Never = "Rarely", Lt Once A Year = "Rarely", Once A Year = "Rarely",
Sevrl Times A Yr = "Rarely"))
x <- c("a", "b", "c")
revalue(x, c("a" = "A", "c" = "C"))
x
x1 <- revalue(x, c("a" = "A", "c" = "C"))
x <- c("a", "b", "c")
x1 <- revalue(x, c("a" = "A", "c" = "C"))
x1
modData2 <- revalue(modData2$attend, c(Never = "Rarely", Lt Once A Year = "Rarely", Once A Year = "Rarely",
modData2 <- revalue(modData2$attend, c("Never" = "Rarely", "Lt Once A Year" = "Rarely", "Once A Year" = "Rarely",
"Sevrl Times A Yr" = "Rarely"))
modData2 <- select(modData, attend, natspac)
modData2 <- modData2 %>% filter(attend != "NA", natspac != "NA")
table(modData2$attend, modData2$natspac)
n_distinct(modData$attend)
levels(modData2$attend)
modData2 <- revalue(modData2$attend, c("Lt Once A Year" = "Rarely"))
modData2 <- select(modData, attend, natspac)
modData2 <- modData2 %>% filter(attend != "NA", natspac != "NA")
table(modData2$attend, modData2$natspac)
n_distinct(modData$attend)
levels(modData2$attend)
modData3 <- revalue(modData2$attend, c("Lt Once A Year" = "Rarely"))
modData3
modData2 <- select(modData, attend, natspac)
modData2 <- modData2 %>% filter(attend != "NA", natspac != "NA")
table(modData2$attend, modData2$natspac)
n_distinct(modData$attend)
levels(modData2$attend)
modData3$attend <- revalue(modData2$attend, c("Lt Once A Year" = "Rarely"))
modData2[modData2$attend=="Lt Once A Year"] <- "Rarely"
View(modData2)
levels(modData2$attend)
oldvalues <- c("Lt Once A Year", "Once A Year", "Sevrl Times A Yr", "Never")
oldvalues <- c("Lt Once A Year", "Once A Year", "Sevrl Times A Yr", "Never")
newvalues <- factor("Rarely")
modData2$attend <- newvalues[match(modData2$attend, oldvalues)]
modData2 <- select(modData, attend, natspac)
modData2 <- modData2 %>% filter(attend != "NA", natspac != "NA")
table(modData2$attend, modData2$natspac)
n_distinct(modData$attend)
levels(modData2$attend)
str(modData2)
x <- factor(c("alpha","beta","gamma","alpha","beta"))
class(x)
levels(modData2$attend)[levels(modData2$attend)=="Once A Year"] <- "Rarely"
levels(modData2$attend)
levels(modData2$attend)
levels(modData2$attend)[levels(modData2$attend)==c("Lt Once A Year", "Sevrl Times A Yr") ] <- "Rarely"
levels(modData2$attend)[levels(modData2$attend)=="Lt Once A Year"] <- "Rarely"
levels(modData2$attend)
levels(modData2$attend)[levels(modData2$attend)=="Once A Month"] <- "Rarely"
levels(modData2$attend)
levels(modData2$attend)[levels(modData2$attend)=="Never"] <- "Rarely"
n_distinct(modData$attend)
levels(modData2$attend)
levels(modData2$attend)[levels(modData2$attend)=="2-3X A Month"] <- "Often"
levels(modData2$attend)[levels(modData2$attend)=="Nrly Every Week"] <- "Often"
levels(modData2$attend)[levels(modData2$attend)=="Every Week"] <- "Often"
levels(modData2$attend)[levels(modData2$attend)=="More Thn Once Wk"] <- "Often"
levels(modData2$attend)
modData2 <- select(modData, attend, natspac)
modData2 <- modData2 %>% filter(attend != "NA", natspac != "NA")
levels(modData2$attend)
modData2$attend <- revalue(modData2$attend, c("Never"="Rarely", "Lt Once A Year"="Rarely", "Once A Year"="Rarely"))
levels(modData2$attend)
modData2 <- select(modData, attend, natspac)
modData2 <- modData2 %>% filter(attend != "NA", natspac != "NA")
levels(modData2$attend)
modData2$attend <- revalue(modData2$attend, c("Never"="Rarely", "Lt Once A Year"="Rarely", "Once A Year"="Rarely", "Sevrl Times A Yr"=Rarely))
modData2$attend <- revalue(modData2$attend, c("Never"="Rarely", "Lt Once A Year"="Rarely", "Once A Year"="Rarely", "Sevrl Times A Yr"="Rarely"))
modData2$attend <- revalue(modData2$attend, c("Once A Month"="Frequently", "2-3X A Month"="Frequently", "Nrly Every Week"="Frequently",
"Every Week"="Frequently", "More Thn Once Wk"="Frequently"))
source('~/GitHub/Duke_Statistics_R/Inferential/project/WIPcode.R')
View(modData2)
table(modData)
table(modData2)
plot(modData2$attend, modData2$natspac)
prop.table(modData2)
prop.table(as.table(modData2))
library(brewer)
plot(modData2$attend, modData2$natspac, col(brewer.pal(3, "Set3")))
?brewer.pal
??brewer.pal
p <- brewer.pal(3, "Set3")
library(RColorBrewer)
p <- brewer.pal(3, "Set3")
plot(modData2$attend, modData2$natspac, col=p)
p <- brewer.pal(3, "Accent")
plot(modData2$attend, modData2$natspac, col=p)
?brewer.pal
display.brewer.pal()
plot(modData2$attend, modData2$natspac, col=brewer.pal(3, "Accent"))
plot(gss$attend)
plot(gss$attend,  col=brewer.pal(3, "Accent"))
ggplot(gss, aes(x=attend)) + geom_bar()
ggplot(gss, aes(x=attend, color=attend)) + geom_bar()
ggplot(gss, aes(x=attend, fill=factor(attend))) + geom_bar()
ggplot(gss, aes(x=attend, fill=factor(attend))) + geom_bar() + options(axis.text.x=theme_text(angle=90))
ggplot(gss, aes(x=attend, fill=factor(attend))) + geom_bar() + opts(axis.text.x=theme_text(angle=90))
ggplot(gss, aes(x=attend, fill=factor(attend))) + geom_bar() + theme(axis.text.x=element_text(angle=90))
ggplot(modData2, aes(attend, natspac)) + geom_raster(aes(fill=n(attend)))
library(vcd)
P10 <- mosaic(~attend + natspac, data = modData2, shade=TRUE)
ggplot(gss, aes(x=natspac, fill=factor(attend))) + geom_bar() + theme(axis.text.x=element_text(angle=90))
ggplot(gss, aes(x=natspac, fill=factor(natspac))) + geom_bar() + theme(axis.text.x=element_text(angle=90))
?cumsum
table(modData2)
cumsum(modData2)
class(modData2)
cumsum(modData2$attend)
cumsum(n(modData2$attend))
modData3 <- modData2 %>% mutate(Rarely_Cnt=cumsum(Rarely))
table(modData2)
tmpTable <- table(modData2)
tmpTable
margin.table(tmpTable, 1)
margin.table(tmpTable, 2)
addmargins(tmpTable)
table(modData2)
tmpTable <- table(modData2)
tmpTable <- addmargins(tmpTable)
tmpTable
library(ggplot2)
library(plyr)#Used for the revalue function
library(dplyr)
library(RColorBrewer)
library(statsr)
load("./Inferential/project/gss.Rdata")
varsOfInterest <- c("year", "age", "sex", "race", "degree", "incom16", "relig", "attend", "class", "natspac")
modData <- select(gss, one_of(varsOfInterest))
countNAs <- apply(modData, 2, function(x) sum(is.na(x)))
countNAs#25834
modData2 <- select(modData, attend, natspac)
modData2 <- modData2 %>% filter(attend != "NA", natspac != "NA")
table(modData2$attend, modData2$natspac)
n_distinct(modData$attend)
levels(modData2$attend)
droplevels(modData2$attend)
levels(modData2$attend)
table(modData2$attend, modData2$natspac)
levels(modData)
levels(modData$attend)
table(modData$attend)
levels(modData$attend)
modData2 <- select(modData, attend, natspac)
modData2 <- modData2 %>% filter(attend != "NA", natspac != "NA")
table(modData2$attend, modData2$natspac)
levels(modData2$attend)
modData2$attend
View(modData2)
library(ggplot2)
library(plyr)#Used for the revalue function
library(dplyr)
library(RColorBrewer)
library(statsr)
load("./Inferential/project/gss.Rdata")
varsOfInterest <- c("year", "age", "sex", "race", "degree", "incom16", "relig", "attend", "class", "natspac")
modData <- select(gss, one_of(varsOfInterest))
countNAs <- apply(modData, 2, function(x) sum(is.na(x)))
countNAs#25834
modData2 <- select(modData, attend, natspac)
modData2 <- modData2 %>% filter(attend != "NA", natspac != "NA")
table(modData2$attend, modData2$natspac)
n_distinct(modData$attend)
levels(modData2$attend)
tmpTable <- table(modData2)
tmpTable <- addmargins(tmpTable)
tmpTable
View(modData)
View(modData2)
tmpTable <- table(modData2$attend, modData2$natspac)
tmpTable
tmpTable <- table(modData2$natspac, modData2$attend)
tmpTable <- addmargins(tmpTable)
tmpTable
summarise(modData2)
str(modData2)
modData2$attend <- modData2$attend[1:8, drop=TRUE]
str(modData2)
modData2$attend
levels(modData2$attend)
modData2$attend <- modData2$attend[]modData2$attend!'"Never"]'
modData2$attend <- modData2$attend[modData2$attend!'"Never"]
modData2$attend <- modData2$attend[modData2$attend !="Never"]
modData2$attend <- factor(modData2$attend)
levels(modaData2$attned)
levels(modaData2$attend)
levels(modData2$attend
)
load("gss.Rdata")
load("./Inference/project/gss.Rdata")
load("./Inferential/project/gss.Rdata")
getwd()
load("./Inferential/project/gss.Rdata")
load("~/GitHub/Duke_Statistics_R/Inferential/project/gss.Rdata")
brary(ggplot2)
library(plyr)#Used for the revalue function
library(dplyr)
library(RColorBrewer)
library(statsr)
load("./Inferential/project/gss.Rdata")
varsOfInterest <- c("year", "age", "sex", "race", "degree", "incom16", "relig", "attend", "class", "natspac")
modData <- select(gss, one_of(varsOfInterest))
countNAs <- apply(modData, 2, function(x) sum(is.na(x)))
countNAs#25834
modData2 <- select(modData, attend, natspac)
modData2 <- modData2 %>% filter(attend != "NA", natspac != "NA")
table(modData2$attend, modData2$natspac)
n_distinct(modData$attend)
levels(modData2$attend)
#to drop factor see http://www.r-bloggers.com/r-drop-factor-levels-in-a-dataset/
modData2$attend <- modData2$attend[modData2$attend !="Never"]
modData2$attend <- factor(modData2$attend)
levels(modData2$attend)
modData2$attend <- revalue(modData2$attend, c("Never"="Rarely", "Lt Once A Year"="Rarely", "Once A Year"="Rarely", "Sevrl Times A Yr"="Rarely"))
modData2$attend <- revalue(modData2$attend, c("Once A Month"="Frequently", "2-3X A Month"="Frequently", "Nrly Every Week"="Frequently",
"Every Week"="Frequently", "More Thn Once Wk"="Frequently"))
table(modData2)
tmpTable <- table(modData2$natspac, modData2$attend)
tmpTable <- addmargins(tmpTable)
plot(modData2$attend, modData2$natspac, col=brewer.pal(3, "Accent"))
tmpTable
overall_frq <- tmpTable[2,4]/tmpTable[3,4]
table(modData2)
tmpTable <- addmargins(tmpTable)
tmpTable
table(modData2)
tmpTable <- addmargins(tmpTable)
tmpTable
table(modData2)
tmpTable <- addmargins(Table)
tmpTable <- addmargins(table(modData2))
tmpTable
overall_frq <- tmpTable[2,4]/tmpTable[3,4]
overall_rare <- tmpTable[1,4]/tmpTable[3,4]
tmpTable[1,1]
overall_rare
tmpTable[1,1] * overall_rare
round(tmpTable[1,1] * overall_rare)
tmpTable[2,1]
overall_frq
round(tmpTable[2,1] * overall_frq)
rare_little <- round(tmpTable[1,1] * overall_rare)
rare_right <- round(tmpTable[1,2] * overall_rare)
rare_much <- round(tmpTable[1,3] * overall_rare)
frq_little <- round(tmpTable[2,1] * overall_frq)
frq_right <- round(tmpTable[2,2] * overall_frq)
frq_much <- round(tmpTable[2,3] * overall_frq)
rare_little + rare_right + rare_much
rare_little
tmpTable[1,1]
tmpTable[1,4]
tmpTable[3,4]
overall_rare <- tmpTable[1,4]/tmpTable[3,4]
tmpTable[3,3]
rare_little <- round(tmpTable[3,1] * overall_rare)
rare_right <- round(tmpTable[3,2] * overall_rare)
rare_much <- round(tmpTable[3,3] * overall_rare)
rare_total <- rare_little + rare_right + rare_much
frq_little <- round(tmpTable[3,1] * overall_frq)
frq_right <- round(tmpTable[3,2] * overall_frq)
frq_much <- round(tmpTable[3,3] * overall_frq)
frq_total <- frq_little + frq_right + frq_much
rarely <- c(1591, 4358, 4671)
frequently <- c(1486, 6248, 7700)
religion_space <- as.data.frame(rbind(rarely, frequently))
View(religion_space)
names(religion_space) <- c("Too Little", "About Right", "Too Much")
View(religion_space)
chisq.test(religion_space)
load("gss.Rdata")
load("./Inferential/project/gss.Rdata")
varsOfInterest <- c("attend", "natspac")
modData <- select(gss, one_of(varsOfInterest))
countNAs <- apply(modData, 2, function(x) sum(is.na(x)))
countNAs#25834
countNAs
modData2 <- modData %>% filter(attend != "NA", natspac != "NA")
summary(modData2)
modData <- select(gss, one_of(varsOfInterest))#57061 records
View(gss)
varsOfInterest <- c("year", "attend", "natspac")
modData <- select(gss, one_of(varsOfInterest))#57061 records
countNAs <- apply(modData, 2, function(x) sum(is.na(x)))
countNAs
summary(modData)
modData %>% group_by(year) %>% summarize(yearCNT = n())
varsOfInterest <- c("year", "attend", "natspac")
modData <- select(gss, one_of(varsOfInterest))#57061 records
countNAs <- apply(modData, 2, function(x) sum(is.na(x)))
countNAs
summary(modData)
modData <- modData %>% filter(year>1999)
summary(modData)
modData$year <- null
modData$year <- NULL
countNAs <- apply(modData, 2, function(x) sum(is.na(x)))
countNAs
glimpse(modData)
modData <- modData %>% filter(attend != "NA", natspac != "NA")# records
summary(modData)
table(modData)
dim(modData)
table(modData)
n_distinct(modData$attend)
levels(modData$attend)
table(modData)
levels(modData$attend)
modData$attend <- modData$attend[modData$attend !="Never"]
modData$attend <- factor(modData$attend)
levels(modData$attend)
table(modData)
ggplot(modData, aes(x=attend, fill=factor(attend))) + geom_bar() + theme(axis.text.x=element_text(angle=90))
library(ggplot2)
library(plyr)#Used for the revalue function
library(dplyr)
library(RColorBrewer)
library(statsr)
ggplot(modData, aes(x=attend, fill=factor(attend))) + geom_bar() + theme(axis.text.x=element_text(angle=90))
ggplot(modData, aes(x=natspac, fill=factor(natspac))) + geom_bar() + theme(axis.text.x=element_text(angle=90))
ggplot(modData, aes(x=attend, fill=factor(attend))) + geom_bar() + theme(axis.text.x=element_text(angle=90)) +
ggtitle(Frequency of Attendance /n at Religious Services)
ggplot(modData, aes(x=attend, fill=factor(attend))) + geom_bar() + theme(axis.text.x=element_text(angle=90)) +
ggtitle("Frequency of Attendance /n at Religious Services")
ggtitle("Frequency of Attendance\nat Religious Services")
ggplot(modData, aes(x=attend, fill=factor(attend))) + geom_bar() + theme(axis.text.x=element_text(angle=90)) +
ggtitle("Frequency of Attendance\nat Religious Services")
ggplot(modData, aes(x=attend, fill=factor(attend))) + geom_bar() + theme(axis.text.x=element_blank()) +
ggtitle("Frequency of Attendance\nat Religious Services")
ggplot(modData, aes(x=attend, fill=factor(attend))) + geom_bar() + theme(axis.text.x=element_blank(), axis.ticks=element_blank()) +
ggtitle("Frequency of Attendance\nat Religious Services")
ggplot(modData, aes(x=natspac, fill=factor(natspac))) + geom_bar() + theme(axis.text.x=element_blank(), axis.ticks=element_blank()) +
ggtitle("Frequency of Attendance\nat Religious Services")
ggplot(modData, aes(x=natspac, fill=factor(natspac))) + geom_bar() + theme(axis.text.x=element_blank(), axis.ticks=element_blank()) +
ggtitle("Public Support for\nSpace Exploration")
plot(modData$attend, modData$natspac, col=brewer.pal(3, "Accent"))
View(modData)
levels(modData)
modData
modData$attend <- revalue(modData$attend, c("Never"="Rarely", "Lt Once A Year"="Rarely", "Once A Year"="Rarely", "Sevrl Times A Yr"="Rarely"))
modData$attend <- revalue(modData$attend, c("Lt Once A Year"="Rarely", "Once A Year"="Rarely", "Sevrl Times A Yr"="Rarely"))
modData$attend <- revalue(modData$attend, c("Once A Month"="Frequently", "2-3X A Month"="Frequently", "Nrly Every Week"="Frequently",
"Every Week"="Frequently", "More Thn Once Wk"="Frequently"))
plot(modData$attend, modData$natspac, col=brewer.pal(3, "Accent"))
ggplot(modData, aes(x=attend, fill=factor(attend))) + geom_bar() + theme(axis.text.x=element_blank(), axis.ticks=element_blank()) +
ggtitle("Frequency of Attendance\nat Religious Services")
levels(modData$natspac)
library(vcd)
3 level
plot(modData$attend, modData$natspac, col=brewer.pal(3, "Accent"))
library(vcd)
P10 <- mosaic(~attend + natspac, data = modData, shade=TRUE)
tmpTable <- addmargins(table(modData))
tmpTable
library(ggplot2)
library(plyr)#Used for the revalue function
library(dplyr)
library(RColorBrewer)
library(statsr)
### Load data
#load("./Inferential/project/gss.Rdata")
load("gss.Rdata")
load("~/GitHub/Duke_Statistics_R/Inferential/project/gss.Rdata")
#Prepare data
varsOfInterest <- c("year", "attend", "natspac")
modData <- select(gss, one_of(varsOfInterest))#57061 records
summary(modData)
modData <- modData %>% filter(year>1999)
summary(modData)
modData$year <- NULL
countNAs <- apply(modData, 2, function(x) sum(is.na(x)))
countNAs
modData <- modData %>% filter(attend != "NA", natspac != "NA")# records
dim(modData)
summary(modData)
table(modData)
#to drop factor see http://www.r-bloggers.com/r-drop-factor-levels-in-a-dataset/
modData$attend <- modData$attend[modData$attend !="Never"]
modData$attend <- factor(modData$attend)
table(modData)
modData$attend <- revalue(modData$attend, c("Lt Once A Year"="Rarely", "Once A Year"="Rarely", "Sevrl Times A Yr"="Rarely"))
modData$attend <- revalue(modData$attend, c("Once A Month"="Frequently", "2-3X A Month"="Frequently", "Nrly Every Week"="Frequently",
"Every Week"="Frequently", "More Thn Once Wk"="Frequently"))
tmpTable <- addmargins(table(modData))
tmpTable
#Overall frequent attendance rate in the sample
overall_frq <- tmpTable[2,4]/tmpTable[3,4]
overall_rare <- tmpTable[1,4]/tmpTable[3,4]
#calculate expected
rare_little <- round(tmpTable[3,1] * overall_rare)
rare_right <- round(tmpTable[3,2] * overall_rare)
rare_much <- round(tmpTable[3,3] * overall_rare)
rare_total <- rare_little + rare_right + rare_much
frq_little <- round(tmpTable[3,1] * overall_frq)
frq_right <- round(tmpTable[3,2] * overall_frq)
frq_much <- round(tmpTable[3,3] * overall_frq)
frq_total <- frq_little + frq_right + frq_much
tmpTable
plot(modData$attend, modData$natspac, col=brewer.pal(3, "Accent"), xlab="", ylab="")
plot(modData$attend, modData$natspac, col=brewer.pal(3, "Accent"), xlab="Religious Services Frequency", ylab="Support of Space Exploration")
